const moreFeedbackBtn=document.querySelector("#more-feedback-btn");let listLength,listStart=0,listEnd=listStart+4;const acceptFeedback=async e=>{const{firstName:t,email:n,country:c,feedback:a,date:i,accepted:d,_id:s}=e,o={firstName:t,email:n,country:c,feedback:a,date:i||"",accepted:!0};const l={method:"POST",headers:{"Content-type":"application/json","auth-token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZTU2OGI3ZGVhNWE4MzQxM2U0M2RjMTIiLCJpYXQiOjE1ODMwODU3NDN9.xX8_VysEZVWlYVLItbV-Azk88ZT772zjyn0PxyZ0x9Q","Access-Control-Allow-Origin":"*"},body:JSON.stringify(o)};try{await fetch("https://bonbonfrancais.herokuapp.com/feedback/"+s,l).then(e=>{document.querySelector(`#feedback-btns-${s}`).innerHTML=`<div class="feedback-accepted"><i class="fas fa-check-circle"></i><span>Коментар від "${t}" з текстом "${a}" успішно затвердженно.</span></div>`})}catch(e){console.warn(e)}},rejectFeedback=async e=>{const{firstName:t,feedback:n,_id:c}=e;const a={method:"DELETE",headers:{"Content-type":"application/json","auth-token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZTU2OGI3ZGVhNWE4MzQxM2U0M2RjMTIiLCJpYXQiOjE1ODMwODU3NDN9.xX8_VysEZVWlYVLItbV-Azk88ZT772zjyn0PxyZ0x9Q","Access-Control-Allow-Origin":"*"}};try{await fetch("https://bonbonfrancais.herokuapp.com/feedback/"+c,a).then(e=>{document.querySelector(`#feedback-btns-${c}`).innerHTML=`<div class="feedback-rejected"><i class="fas fa-times-circle"></i><span>Коментар від "${t}" з текстом "${n}" успішно видаленно.</span></div>`})}catch(e){console.warn(e)}},getFeedbackAPI=async e=>{const t={method:"GET",headers:{"Content-type":"application/json","auth-token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZTU2OGI3ZGVhNWE4MzQxM2U0M2RjMTIiLCJpYXQiOjE1ODMwODU3NDN9.xX8_VysEZVWlYVLItbV-Azk88ZT772zjyn0PxyZ0x9Q","Access-Control-Allow-Origin":"*"}};let n={listStart:listStart,listEnd:listEnd},c=new URL("https://bonbonfrancais.herokuapp.com/feedback/"+e);for(let e in n)c.searchParams.append(e,n[e]);try{await fetch(c,t).then(e=>e.json()).then(t=>{listLength=t.length,t.map(t=>{let n=document.createElement("article");n.innerHTML=`\n        <div class="feedback-container row openWindow">\n        <div class="feedback-left-col col-sm-12 col-md-3">\n        <h3>${t.firstName}</h3>\n        <h4>${t.country}</h4>\n      </div>\n          <div class="feedback-right-col col-sm-12 col-md-9">\n            <span>"${t.feedback}"</span>\n            <p>${t.date.split("T")[0]}</p>\n          </div>\n          ${localStorageName?`<div id="feedback-btns-${t._id}">\n           <button id="acceptFeedback-${t._id}" type="button" class="btn btn-success">\n  Затвердити\n</button>\n          <button id="rejectFeedback-${t._id}" type="button" class="btn btn-danger">\n  Відхилити\n</button>\n          </div>\n          `:""}\n        </div>\n        `,feedbackContainer.appendChild(n),n.classList.add("feedback-content","container-fluid"),localStorageName&&t.accepted==e&&(document.querySelector(`#acceptFeedback-${t._id}`).addEventListener("click",()=>acceptFeedback(t)),document.querySelector(`#rejectFeedback-${t._id}`).addEventListener("click",()=>rejectFeedback(t)))})})}catch(e){console.warn(e)}},getFeedback=async()=>{loadingBtnToggle(!0,moreFeedbackBtn),localStorageName?await getFeedbackAPI(!1):await getFeedbackAPI(!0),listLength<4&&(moreFeedbackBtn.style.display="none"),loadingBtnToggle(!1,moreFeedbackBtn),increaseStartEnd()},increaseStartEnd=()=>{listStart+=4,listEnd+=4};moreFeedbackBtn.addEventListener("click",()=>getFeedback());